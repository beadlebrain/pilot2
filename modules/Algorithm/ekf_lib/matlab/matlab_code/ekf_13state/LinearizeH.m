function H=LinearizeH(X,Be)
q0=X(7);
q1=X(8);
q2=X(9);
q3=X(10);
H=zeros(8,13);
%dP/dP=I;
H(1:3,1:3)=eye(3);
%dV/dV=I;
H(4:5,4:6)=[1,0,0;0,1,0];
%dBb/dq
H(6,7) = 2.0 * (q0 * Be(1) + q3 * Be(2) - q2 * Be(3));
H(6,8) = 2.0 * (q1 * Be(1) + q2 * Be(2) + q3 * Be(3));
H(6,9) = 2.0 * (-q2 * Be(1) + q1 * Be(2) - q0 * Be(3));
H(6,10) = 2.0 * (-q3 * Be(1) + q0 * Be(2) + q1 * Be(3));
H(7,7) = 2.0 * (-q3 * Be(1) + q0 * Be(2) + q1 * Be(3));
H(7,8) = 2.0 * (q2 * Be(1) - q1 * Be(2) + q0 * Be(3));
H(7,9) = 2.0 * (q1 * Be(1) + q2 * Be(2) + q3 * Be(3));
H(7,10) = 2.0 * (-q0 * Be(1) - q3 * Be(2) + q2 * Be(3));
H(8,7) = 2.0 * (q2 * Be(1) - q1 * Be(2) + q0 * Be(3));
H(8,8) = 2.0 * (q3 * Be(1) - q0 * Be(2) - q1 * Be(3));
H(8,9) = 2.0 * (q0 * Be(1) + q3 * Be(2) - q2 * Be(3));
H(8,10) = 2.0 * (q1 * Be(1) + q2 * Be(2) + q3 * Be(3));
