<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="39,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T29U3">H</span>=LinearizeH(<span class="var type1" id="S3T2U6">X</span>,<span class="var type1" id="S4T9U7">Be</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="39,2" id="srcline2"> 2</a></span><span class="line"><span class="mxinfo" id="T3:U4"><span class="var type1" id="S5T3U10">q0</span>=<span class="mxinfo" id="T3:U6"><span class="var type1" id="S3T2U12">X</span>(<span class="mxinfo" id="T4:U8">7</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="39,3" id="srcline3"> 3</a></span><span class="line"><span class="mxinfo" id="T3:U9"><span class="var type1" id="S6T3U16">q1</span>=<span class="mxinfo" id="T3:U11"><span class="var type1" id="S3T2U18">X</span>(<span class="mxinfo" id="T4:U13">8</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="39,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo" id="T3:U14"><span class="var type1" id="S7T3U22">q2</span>=<span class="mxinfo" id="T3:U16"><span class="var type1" id="S3T2U24">X</span>(<span class="mxinfo" id="T4:U18">9</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="39,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo" id="T3:U19"><span class="var type1" id="S8T3U28">q3</span>=<span class="mxinfo" id="T3:U21"><span class="var type1" id="S3T2U30">X</span>(<span class="mxinfo" id="T4:U23">10</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="39,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo" id="T29:U24"><span class="var type1" id="S2T29U34">H</span>=<span class="mxinfo" id="T29:U26">zeros(<span class="mxinfo" id="T4:U27">8</span>,<span class="mxinfo" id="T4:U28">13</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="39,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">%dP/dP=I;</span></span></span>
<span class="srcline"><span class="lineno"><a href="39,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo" id="T28:U29"><span class="mxinfo" id="T28:U30"><span class="var type1" id="S2T29U42">H</span>(<span class="mxinfo" id="T56:U32"><span class="mxinfo" id="T4:U33">1</span>:<span class="mxinfo" id="T4:U34">3</span></span>,<span class="mxinfo" id="T56:U35"><span class="mxinfo" id="T4:U36">1</span>:<span class="mxinfo" id="T4:U37">3</span></span>)</span>=<span class="mxinfo" id="T28:U38">eye(3)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="39,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">%dV/dV=I;</span></span></span>
<span class="srcline"><span class="lineno"><a href="39,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo" id="T57:U39"><span class="mxinfo" id="T57:U40"><span class="var type1" id="S2T29U55">H</span>(<span class="mxinfo" id="T58:U42"><span class="mxinfo" id="T4:U43">4</span>:<span class="mxinfo" id="T4:U44">5</span></span>,<span class="mxinfo" id="T56:U45"><span class="mxinfo" id="T4:U46">4</span>:<span class="mxinfo" id="T4:U47">6</span></span>)</span>=<span class="mxinfo" id="T57:U48">[<span class="mxinfo" id="T56:U49"><span class="mxinfo" id="T4:U50">1</span>,<span class="mxinfo" id="T4:U51">0</span>,<span class="mxinfo" id="T4:U52">0</span></span>;<span class="mxinfo" id="T56:U53"><span class="mxinfo" id="T4:U54">0</span>,<span class="mxinfo" id="T4:U55">1</span>,<span class="mxinfo" id="T4:U56">0</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="39,11" id="srcline11">11</a></span><span class="line"><span class="comment">%dBb/dq</span></span></span>
<span class="srcline"><span class="lineno"><a href="39,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo" id="T4:U57"><span class="mxinfo" id="T4:U58"><span class="var type1" id="S2T29U74">H</span>(<span class="mxinfo" id="T4:U60">6</span>,<span class="mxinfo" id="T4:U61">7</span>)</span> = <span class="mxinfo" id="T3:U62">2.0 * (<span class="mxinfo" id="T3:U63"><span class="mxinfo" id="T3:U64"><span class="mxinfo" id="T3:U65"><span class="var type1" id="S5T3U83">q0</span> * <span class="mxinfo" id="T3:U67"><span class="var type1" id="S4T9U85">Be</span>(<span class="mxinfo" id="T4:U69">1</span>)</span></span> + <span class="mxinfo" id="T3:U70"><span class="var type1" id="S8T3U88">q3</span> * <span class="mxinfo" id="T3:U72"><span class="var type1" id="S4T9U90">Be</span>(<span class="mxinfo" id="T4:U74">2</span>)</span></span></span> - <span class="mxinfo" id="T3:U75"><span class="var type1" id="S7T3U93">q2</span> * <span class="mxinfo" id="T3:U77"><span class="var type1" id="S4T9U95">Be</span>(<span class="mxinfo" id="T4:U79">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="39,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo" id="T4:U80"><span class="mxinfo" id="T4:U81"><span class="var type1" id="S2T29U100">H</span>(<span class="mxinfo" id="T4:U83">6</span>,<span class="mxinfo" id="T4:U84">8</span>)</span> = <span class="mxinfo" id="T3:U85">2.0 * (<span class="mxinfo" id="T3:U86"><span class="mxinfo" id="T3:U87"><span class="mxinfo" id="T3:U88"><span class="var type1" id="S6T3U109">q1</span> * <span class="mxinfo" id="T3:U90"><span class="var type1" id="S4T9U111">Be</span>(<span class="mxinfo" id="T4:U92">1</span>)</span></span> + <span class="mxinfo" id="T3:U93"><span class="var type1" id="S7T3U114">q2</span> * <span class="mxinfo" id="T3:U95"><span class="var type1" id="S4T9U116">Be</span>(<span class="mxinfo" id="T4:U97">2</span>)</span></span></span> + <span class="mxinfo" id="T3:U98"><span class="var type1" id="S8T3U119">q3</span> * <span class="mxinfo" id="T3:U100"><span class="var type1" id="S4T9U121">Be</span>(<span class="mxinfo" id="T4:U102">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="39,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo" id="T4:U103"><span class="mxinfo" id="T4:U104"><span class="var type1" id="S2T29U126">H</span>(<span class="mxinfo" id="T4:U106">6</span>,<span class="mxinfo" id="T4:U107">9</span>)</span> = <span class="mxinfo" id="T3:U108">2.0 * (<span class="mxinfo" id="T3:U109"><span class="mxinfo" id="T3:U110"><span class="mxinfo" id="T3:U111"><span class="mxinfo" id="T3:U112">-<span class="var type1" id="S7T3U136">q2</span></span> * <span class="mxinfo" id="T3:U114"><span class="var type1" id="S4T9U138">Be</span>(<span class="mxinfo" id="T4:U116">1</span>)</span></span> + <span class="mxinfo" id="T3:U117"><span class="var type1" id="S6T3U141">q1</span> * <span class="mxinfo" id="T3:U119"><span class="var type1" id="S4T9U143">Be</span>(<span class="mxinfo" id="T4:U121">2</span>)</span></span></span> - <span class="mxinfo" id="T3:U122"><span class="var type1" id="S5T3U146">q0</span> * <span class="mxinfo" id="T3:U124"><span class="var type1" id="S4T9U148">Be</span>(<span class="mxinfo" id="T4:U126">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="39,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo" id="T4:U127"><span class="mxinfo" id="T4:U128"><span class="var type1" id="S2T29U153">H</span>(<span class="mxinfo" id="T4:U130">6</span>,<span class="mxinfo" id="T4:U131">10</span>)</span> = <span class="mxinfo" id="T3:U132">2.0 * (<span class="mxinfo" id="T3:U133"><span class="mxinfo" id="T3:U134"><span class="mxinfo" id="T3:U135"><span class="mxinfo" id="T3:U136">-<span class="var type1" id="S8T3U163">q3</span></span> * <span class="mxinfo" id="T3:U138"><span class="var type1" id="S4T9U165">Be</span>(<span class="mxinfo" id="T4:U140">1</span>)</span></span> + <span class="mxinfo" id="T3:U141"><span class="var type1" id="S5T3U168">q0</span> * <span class="mxinfo" id="T3:U143"><span class="var type1" id="S4T9U170">Be</span>(<span class="mxinfo" id="T4:U145">2</span>)</span></span></span> + <span class="mxinfo" id="T3:U146"><span class="var type1" id="S6T3U173">q1</span> * <span class="mxinfo" id="T3:U148"><span class="var type1" id="S4T9U175">Be</span>(<span class="mxinfo" id="T4:U150">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="39,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo" id="T4:U151"><span class="mxinfo" id="T4:U152"><span class="var type1" id="S2T29U180">H</span>(<span class="mxinfo" id="T4:U154">7</span>,<span class="mxinfo" id="T4:U155">7</span>)</span> = <span class="mxinfo" id="T3:U156">2.0 * (<span class="mxinfo" id="T3:U157"><span class="mxinfo" id="T3:U158"><span class="mxinfo" id="T3:U159"><span class="mxinfo" id="T3:U160">-<span class="var type1" id="S8T3U190">q3</span></span> * <span class="mxinfo" id="T3:U162"><span class="var type1" id="S4T9U192">Be</span>(<span class="mxinfo" id="T4:U164">1</span>)</span></span> + <span class="mxinfo" id="T3:U165"><span class="var type1" id="S5T3U195">q0</span> * <span class="mxinfo" id="T3:U167"><span class="var type1" id="S4T9U197">Be</span>(<span class="mxinfo" id="T4:U169">2</span>)</span></span></span> + <span class="mxinfo" id="T3:U170"><span class="var type1" id="S6T3U200">q1</span> * <span class="mxinfo" id="T3:U172"><span class="var type1" id="S4T9U202">Be</span>(<span class="mxinfo" id="T4:U174">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="39,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo" id="T4:U175"><span class="mxinfo" id="T4:U176"><span class="var type1" id="S2T29U207">H</span>(<span class="mxinfo" id="T4:U178">7</span>,<span class="mxinfo" id="T4:U179">8</span>)</span> = <span class="mxinfo" id="T3:U180">2.0 * (<span class="mxinfo" id="T3:U181"><span class="mxinfo" id="T3:U182"><span class="mxinfo" id="T3:U183"><span class="var type1" id="S7T3U216">q2</span> * <span class="mxinfo" id="T3:U185"><span class="var type1" id="S4T9U218">Be</span>(<span class="mxinfo" id="T4:U187">1</span>)</span></span> - <span class="mxinfo" id="T3:U188"><span class="var type1" id="S6T3U221">q1</span> * <span class="mxinfo" id="T3:U190"><span class="var type1" id="S4T9U223">Be</span>(<span class="mxinfo" id="T4:U192">2</span>)</span></span></span> + <span class="mxinfo" id="T3:U193"><span class="var type1" id="S5T3U226">q0</span> * <span class="mxinfo" id="T3:U195"><span class="var type1" id="S4T9U228">Be</span>(<span class="mxinfo" id="T4:U197">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="39,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo" id="T4:U198"><span class="mxinfo" id="T4:U199"><span class="var type1" id="S2T29U233">H</span>(<span class="mxinfo" id="T4:U201">7</span>,<span class="mxinfo" id="T4:U202">9</span>)</span> = <span class="mxinfo" id="T3:U203">2.0 * (<span class="mxinfo" id="T3:U204"><span class="mxinfo" id="T3:U205"><span class="mxinfo" id="T3:U206"><span class="var type1" id="S6T3U242">q1</span> * <span class="mxinfo" id="T3:U208"><span class="var type1" id="S4T9U244">Be</span>(<span class="mxinfo" id="T4:U210">1</span>)</span></span> + <span class="mxinfo" id="T3:U211"><span class="var type1" id="S7T3U247">q2</span> * <span class="mxinfo" id="T3:U213"><span class="var type1" id="S4T9U249">Be</span>(<span class="mxinfo" id="T4:U215">2</span>)</span></span></span> + <span class="mxinfo" id="T3:U216"><span class="var type1" id="S8T3U252">q3</span> * <span class="mxinfo" id="T3:U218"><span class="var type1" id="S4T9U254">Be</span>(<span class="mxinfo" id="T4:U220">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="39,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo" id="T4:U221"><span class="mxinfo" id="T4:U222"><span class="var type1" id="S2T29U259">H</span>(<span class="mxinfo" id="T4:U224">7</span>,<span class="mxinfo" id="T4:U225">10</span>)</span> = <span class="mxinfo" id="T3:U226">2.0 * (<span class="mxinfo" id="T3:U227"><span class="mxinfo" id="T3:U228"><span class="mxinfo" id="T3:U229"><span class="mxinfo" id="T3:U230">-<span class="var type1" id="S5T3U269">q0</span></span> * <span class="mxinfo" id="T3:U232"><span class="var type1" id="S4T9U271">Be</span>(<span class="mxinfo" id="T4:U234">1</span>)</span></span> - <span class="mxinfo" id="T3:U235"><span class="var type1" id="S8T3U274">q3</span> * <span class="mxinfo" id="T3:U237"><span class="var type1" id="S4T9U276">Be</span>(<span class="mxinfo" id="T4:U239">2</span>)</span></span></span> + <span class="mxinfo" id="T3:U240"><span class="var type1" id="S7T3U279">q2</span> * <span class="mxinfo" id="T3:U242"><span class="var type1" id="S4T9U281">Be</span>(<span class="mxinfo" id="T4:U244">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="39,20" id="srcline20">20</a></span><span class="line"><span class="mxinfo" id="T4:U245"><span class="mxinfo" id="T4:U246"><span class="var type1" id="S2T29U286">H</span>(<span class="mxinfo" id="T4:U248">8</span>,<span class="mxinfo" id="T4:U249">7</span>)</span> = <span class="mxinfo" id="T3:U250">2.0 * (<span class="mxinfo" id="T3:U251"><span class="mxinfo" id="T3:U252"><span class="mxinfo" id="T3:U253"><span class="var type1" id="S7T3U295">q2</span> * <span class="mxinfo" id="T3:U255"><span class="var type1" id="S4T9U297">Be</span>(<span class="mxinfo" id="T4:U257">1</span>)</span></span> - <span class="mxinfo" id="T3:U258"><span class="var type1" id="S6T3U300">q1</span> * <span class="mxinfo" id="T3:U260"><span class="var type1" id="S4T9U302">Be</span>(<span class="mxinfo" id="T4:U262">2</span>)</span></span></span> + <span class="mxinfo" id="T3:U263"><span class="var type1" id="S5T3U305">q0</span> * <span class="mxinfo" id="T3:U265"><span class="var type1" id="S4T9U307">Be</span>(<span class="mxinfo" id="T4:U267">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="39,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo" id="T4:U268"><span class="mxinfo" id="T4:U269"><span class="var type1" id="S2T29U312">H</span>(<span class="mxinfo" id="T4:U271">8</span>,<span class="mxinfo" id="T4:U272">8</span>)</span> = <span class="mxinfo" id="T3:U273">2.0 * (<span class="mxinfo" id="T3:U274"><span class="mxinfo" id="T3:U275"><span class="mxinfo" id="T3:U276"><span class="var type1" id="S8T3U321">q3</span> * <span class="mxinfo" id="T3:U278"><span class="var type1" id="S4T9U323">Be</span>(<span class="mxinfo" id="T4:U280">1</span>)</span></span> - <span class="mxinfo" id="T3:U281"><span class="var type1" id="S5T3U326">q0</span> * <span class="mxinfo" id="T3:U283"><span class="var type1" id="S4T9U328">Be</span>(<span class="mxinfo" id="T4:U285">2</span>)</span></span></span> - <span class="mxinfo" id="T3:U286"><span class="var type1" id="S6T3U331">q1</span> * <span class="mxinfo" id="T3:U288"><span class="var type1" id="S4T9U333">Be</span>(<span class="mxinfo" id="T4:U290">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="39,22" id="srcline22">22</a></span><span class="line"><span class="mxinfo" id="T4:U291"><span class="mxinfo" id="T4:U292"><span class="var type1" id="S2T29U338">H</span>(<span class="mxinfo" id="T4:U294">8</span>,<span class="mxinfo" id="T4:U295">9</span>)</span> = <span class="mxinfo" id="T3:U296">2.0 * (<span class="mxinfo" id="T3:U297"><span class="mxinfo" id="T3:U298"><span class="mxinfo" id="T3:U299"><span class="var type1" id="S5T3U347">q0</span> * <span class="mxinfo" id="T3:U301"><span class="var type1" id="S4T9U349">Be</span>(<span class="mxinfo" id="T4:U303">1</span>)</span></span> + <span class="mxinfo" id="T3:U304"><span class="var type1" id="S8T3U352">q3</span> * <span class="mxinfo" id="T3:U306"><span class="var type1" id="S4T9U354">Be</span>(<span class="mxinfo" id="T4:U308">2</span>)</span></span></span> - <span class="mxinfo" id="T3:U309"><span class="var type1" id="S7T3U357">q2</span> * <span class="mxinfo" id="T3:U311"><span class="var type1" id="S4T9U359">Be</span>(<span class="mxinfo" id="T4:U313">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="39,23" id="srcline23">23</a></span><span class="line"><span class="mxinfo" id="T4:U314"><span class="mxinfo" id="T4:U315"><span class="var type1" id="S2T29U364">H</span>(<span class="mxinfo" id="T4:U317">8</span>,<span class="mxinfo" id="T4:U318">10</span>)</span> = <span class="mxinfo" id="T3:U319">2.0 * (<span class="mxinfo" id="T3:U320"><span class="mxinfo" id="T3:U321"><span class="mxinfo" id="T3:U322"><span class="var type1" id="S6T3U373">q1</span> * <span class="mxinfo" id="T3:U324"><span class="var type1" id="S4T9U375">Be</span>(<span class="mxinfo" id="T4:U326">1</span>)</span></span> + <span class="mxinfo" id="T3:U327"><span class="var type1" id="S7T3U378">q2</span> * <span class="mxinfo" id="T3:U329"><span class="var type1" id="S4T9U380">Be</span>(<span class="mxinfo" id="T4:U331">2</span>)</span></span></span> + <span class="mxinfo" id="T3:U332"><span class="var type1" id="S8T3U383">q3</span> * <span class="mxinfo" id="T3:U334"><span class="var type1" id="S4T9U385">Be</span>(<span class="mxinfo" id="T4:U336">3</span>)</span></span></span>)</span></span>;</span></span>
</pre>
