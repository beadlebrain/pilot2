<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="46,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T32U3">H</span>=LinearizeH(<span class="var type1" id="S3T14U6">X</span>,<span class="var type1" id="S4T9U7">Be</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="46,2" id="srcline2"> 2</a></span><span class="line"><span class="mxinfo" id="T2:U4"><span class="var type1" id="S5T2U10">q0</span>=<span class="mxinfo" id="T2:U6"><span class="var type1" id="S3T14U12">X</span>(<span class="mxinfo" id="T4:U8">7</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,3" id="srcline3"> 3</a></span><span class="line"><span class="mxinfo" id="T2:U9"><span class="var type1" id="S6T2U16">q1</span>=<span class="mxinfo" id="T2:U11"><span class="var type1" id="S3T14U18">X</span>(<span class="mxinfo" id="T4:U13">8</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo" id="T2:U14"><span class="var type1" id="S7T2U22">q2</span>=<span class="mxinfo" id="T2:U16"><span class="var type1" id="S3T14U24">X</span>(<span class="mxinfo" id="T4:U18">9</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo" id="T2:U19"><span class="var type1" id="S8T2U28">q3</span>=<span class="mxinfo" id="T2:U21"><span class="var type1" id="S3T14U30">X</span>(<span class="mxinfo" id="T4:U23">10</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo" id="T32:U24"><span class="var type1" id="S2T32U34">H</span>=<span class="mxinfo" id="T32:U26">zeros(<span class="mxinfo" id="T4:U27">8</span>,<span class="mxinfo" id="T4:U28">13</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,7" id="srcline7"> 7</a></span><span class="line"><span class="comment">%dP/dP=I;</span></span></span>
<span class="srcline"><span class="lineno"><a href="46,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo" id="T31:U29"><span class="mxinfo" id="T31:U30"><span class="var type1" id="S2T32U42">H</span>(<span class="mxinfo" id="T56:U32"><span class="mxinfo" id="T4:U33">1</span>:<span class="mxinfo" id="T4:U34">3</span></span>,<span class="mxinfo" id="T56:U35"><span class="mxinfo" id="T4:U36">1</span>:<span class="mxinfo" id="T4:U37">3</span></span>)</span>=<span class="mxinfo" id="T31:U38">eye(3)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,9" id="srcline9"> 9</a></span><span class="line"><span class="comment">%dV/dV=I;</span></span></span>
<span class="srcline"><span class="lineno"><a href="46,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo" id="T57:U39"><span class="mxinfo" id="T57:U40"><span class="var type1" id="S2T32U55">H</span>(<span class="mxinfo" id="T58:U42"><span class="mxinfo" id="T4:U43">4</span>:<span class="mxinfo" id="T4:U44">5</span></span>,<span class="mxinfo" id="T56:U45"><span class="mxinfo" id="T4:U46">4</span>:<span class="mxinfo" id="T4:U47">6</span></span>)</span>=<span class="mxinfo" id="T57:U48">[<span class="mxinfo" id="T56:U49"><span class="mxinfo" id="T4:U50">1</span>,<span class="mxinfo" id="T4:U51">0</span>,<span class="mxinfo" id="T4:U52">0</span></span>;<span class="mxinfo" id="T56:U53"><span class="mxinfo" id="T4:U54">0</span>,<span class="mxinfo" id="T4:U55">1</span>,<span class="mxinfo" id="T4:U56">0</span></span>]</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,11" id="srcline11">11</a></span><span class="line"><span class="comment">%dBb/dq</span></span></span>
<span class="srcline"><span class="lineno"><a href="46,12" id="srcline12">12</a></span><span class="line"><span class="mxinfo" id="T4:U57"><span class="mxinfo" id="T4:U58"><span class="var type1" id="S2T32U74">H</span>(<span class="mxinfo" id="T4:U60">6</span>,<span class="mxinfo" id="T4:U61">7</span>)</span> = <span class="mxinfo" id="T2:U62">2.0 * (<span class="mxinfo" id="T2:U63"><span class="mxinfo" id="T2:U64"><span class="mxinfo" id="T2:U65"><span class="var type1" id="S5T2U83">q0</span> * <span class="mxinfo" id="T2:U67"><span class="var type1" id="S4T9U85">Be</span>(<span class="mxinfo" id="T4:U69">1</span>)</span></span> + <span class="mxinfo" id="T2:U70"><span class="var type1" id="S8T2U88">q3</span> * <span class="mxinfo" id="T2:U72"><span class="var type1" id="S4T9U90">Be</span>(<span class="mxinfo" id="T4:U74">2</span>)</span></span></span> - <span class="mxinfo" id="T2:U75"><span class="var type1" id="S7T2U93">q2</span> * <span class="mxinfo" id="T2:U77"><span class="var type1" id="S4T9U95">Be</span>(<span class="mxinfo" id="T4:U79">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo" id="T4:U80"><span class="mxinfo" id="T4:U81"><span class="var type1" id="S2T32U100">H</span>(<span class="mxinfo" id="T4:U83">6</span>,<span class="mxinfo" id="T4:U84">8</span>)</span> = <span class="mxinfo" id="T2:U85">2.0 * (<span class="mxinfo" id="T2:U86"><span class="mxinfo" id="T2:U87"><span class="mxinfo" id="T2:U88"><span class="var type1" id="S6T2U109">q1</span> * <span class="mxinfo" id="T2:U90"><span class="var type1" id="S4T9U111">Be</span>(<span class="mxinfo" id="T4:U92">1</span>)</span></span> + <span class="mxinfo" id="T2:U93"><span class="var type1" id="S7T2U114">q2</span> * <span class="mxinfo" id="T2:U95"><span class="var type1" id="S4T9U116">Be</span>(<span class="mxinfo" id="T4:U97">2</span>)</span></span></span> + <span class="mxinfo" id="T2:U98"><span class="var type1" id="S8T2U119">q3</span> * <span class="mxinfo" id="T2:U100"><span class="var type1" id="S4T9U121">Be</span>(<span class="mxinfo" id="T4:U102">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,14" id="srcline14">14</a></span><span class="line"><span class="mxinfo" id="T4:U103"><span class="mxinfo" id="T4:U104"><span class="var type1" id="S2T32U126">H</span>(<span class="mxinfo" id="T4:U106">6</span>,<span class="mxinfo" id="T4:U107">9</span>)</span> = <span class="mxinfo" id="T2:U108">2.0 * (<span class="mxinfo" id="T2:U109"><span class="mxinfo" id="T2:U110"><span class="mxinfo" id="T2:U111"><span class="mxinfo" id="T2:U112">-<span class="var type1" id="S7T2U136">q2</span></span> * <span class="mxinfo" id="T2:U114"><span class="var type1" id="S4T9U138">Be</span>(<span class="mxinfo" id="T4:U116">1</span>)</span></span> + <span class="mxinfo" id="T2:U117"><span class="var type1" id="S6T2U141">q1</span> * <span class="mxinfo" id="T2:U119"><span class="var type1" id="S4T9U143">Be</span>(<span class="mxinfo" id="T4:U121">2</span>)</span></span></span> - <span class="mxinfo" id="T2:U122"><span class="var type1" id="S5T2U146">q0</span> * <span class="mxinfo" id="T2:U124"><span class="var type1" id="S4T9U148">Be</span>(<span class="mxinfo" id="T4:U126">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,15" id="srcline15">15</a></span><span class="line"><span class="mxinfo" id="T4:U127"><span class="mxinfo" id="T4:U128"><span class="var type1" id="S2T32U153">H</span>(<span class="mxinfo" id="T4:U130">6</span>,<span class="mxinfo" id="T4:U131">10</span>)</span> = <span class="mxinfo" id="T2:U132">2.0 * (<span class="mxinfo" id="T2:U133"><span class="mxinfo" id="T2:U134"><span class="mxinfo" id="T2:U135"><span class="mxinfo" id="T2:U136">-<span class="var type1" id="S8T2U163">q3</span></span> * <span class="mxinfo" id="T2:U138"><span class="var type1" id="S4T9U165">Be</span>(<span class="mxinfo" id="T4:U140">1</span>)</span></span> + <span class="mxinfo" id="T2:U141"><span class="var type1" id="S5T2U168">q0</span> * <span class="mxinfo" id="T2:U143"><span class="var type1" id="S4T9U170">Be</span>(<span class="mxinfo" id="T4:U145">2</span>)</span></span></span> + <span class="mxinfo" id="T2:U146"><span class="var type1" id="S6T2U173">q1</span> * <span class="mxinfo" id="T2:U148"><span class="var type1" id="S4T9U175">Be</span>(<span class="mxinfo" id="T4:U150">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,16" id="srcline16">16</a></span><span class="line"><span class="mxinfo" id="T4:U151"><span class="mxinfo" id="T4:U152"><span class="var type1" id="S2T32U180">H</span>(<span class="mxinfo" id="T4:U154">7</span>,<span class="mxinfo" id="T4:U155">7</span>)</span> = <span class="mxinfo" id="T2:U156">2.0 * (<span class="mxinfo" id="T2:U157"><span class="mxinfo" id="T2:U158"><span class="mxinfo" id="T2:U159"><span class="mxinfo" id="T2:U160">-<span class="var type1" id="S8T2U190">q3</span></span> * <span class="mxinfo" id="T2:U162"><span class="var type1" id="S4T9U192">Be</span>(<span class="mxinfo" id="T4:U164">1</span>)</span></span> + <span class="mxinfo" id="T2:U165"><span class="var type1" id="S5T2U195">q0</span> * <span class="mxinfo" id="T2:U167"><span class="var type1" id="S4T9U197">Be</span>(<span class="mxinfo" id="T4:U169">2</span>)</span></span></span> + <span class="mxinfo" id="T2:U170"><span class="var type1" id="S6T2U200">q1</span> * <span class="mxinfo" id="T2:U172"><span class="var type1" id="S4T9U202">Be</span>(<span class="mxinfo" id="T4:U174">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,17" id="srcline17">17</a></span><span class="line"><span class="mxinfo" id="T4:U175"><span class="mxinfo" id="T4:U176"><span class="var type1" id="S2T32U207">H</span>(<span class="mxinfo" id="T4:U178">7</span>,<span class="mxinfo" id="T4:U179">8</span>)</span> = <span class="mxinfo" id="T2:U180">2.0 * (<span class="mxinfo" id="T2:U181"><span class="mxinfo" id="T2:U182"><span class="mxinfo" id="T2:U183"><span class="var type1" id="S7T2U216">q2</span> * <span class="mxinfo" id="T2:U185"><span class="var type1" id="S4T9U218">Be</span>(<span class="mxinfo" id="T4:U187">1</span>)</span></span> - <span class="mxinfo" id="T2:U188"><span class="var type1" id="S6T2U221">q1</span> * <span class="mxinfo" id="T2:U190"><span class="var type1" id="S4T9U223">Be</span>(<span class="mxinfo" id="T4:U192">2</span>)</span></span></span> + <span class="mxinfo" id="T2:U193"><span class="var type1" id="S5T2U226">q0</span> * <span class="mxinfo" id="T2:U195"><span class="var type1" id="S4T9U228">Be</span>(<span class="mxinfo" id="T4:U197">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,18" id="srcline18">18</a></span><span class="line"><span class="mxinfo" id="T4:U198"><span class="mxinfo" id="T4:U199"><span class="var type1" id="S2T32U233">H</span>(<span class="mxinfo" id="T4:U201">7</span>,<span class="mxinfo" id="T4:U202">9</span>)</span> = <span class="mxinfo" id="T2:U203">2.0 * (<span class="mxinfo" id="T2:U204"><span class="mxinfo" id="T2:U205"><span class="mxinfo" id="T2:U206"><span class="var type1" id="S6T2U242">q1</span> * <span class="mxinfo" id="T2:U208"><span class="var type1" id="S4T9U244">Be</span>(<span class="mxinfo" id="T4:U210">1</span>)</span></span> + <span class="mxinfo" id="T2:U211"><span class="var type1" id="S7T2U247">q2</span> * <span class="mxinfo" id="T2:U213"><span class="var type1" id="S4T9U249">Be</span>(<span class="mxinfo" id="T4:U215">2</span>)</span></span></span> + <span class="mxinfo" id="T2:U216"><span class="var type1" id="S8T2U252">q3</span> * <span class="mxinfo" id="T2:U218"><span class="var type1" id="S4T9U254">Be</span>(<span class="mxinfo" id="T4:U220">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,19" id="srcline19">19</a></span><span class="line"><span class="mxinfo" id="T4:U221"><span class="mxinfo" id="T4:U222"><span class="var type1" id="S2T32U259">H</span>(<span class="mxinfo" id="T4:U224">7</span>,<span class="mxinfo" id="T4:U225">10</span>)</span> = <span class="mxinfo" id="T2:U226">2.0 * (<span class="mxinfo" id="T2:U227"><span class="mxinfo" id="T2:U228"><span class="mxinfo" id="T2:U229"><span class="mxinfo" id="T2:U230">-<span class="var type1" id="S5T2U269">q0</span></span> * <span class="mxinfo" id="T2:U232"><span class="var type1" id="S4T9U271">Be</span>(<span class="mxinfo" id="T4:U234">1</span>)</span></span> - <span class="mxinfo" id="T2:U235"><span class="var type1" id="S8T2U274">q3</span> * <span class="mxinfo" id="T2:U237"><span class="var type1" id="S4T9U276">Be</span>(<span class="mxinfo" id="T4:U239">2</span>)</span></span></span> + <span class="mxinfo" id="T2:U240"><span class="var type1" id="S7T2U279">q2</span> * <span class="mxinfo" id="T2:U242"><span class="var type1" id="S4T9U281">Be</span>(<span class="mxinfo" id="T4:U244">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,20" id="srcline20">20</a></span><span class="line"><span class="mxinfo" id="T4:U245"><span class="mxinfo" id="T4:U246"><span class="var type1" id="S2T32U286">H</span>(<span class="mxinfo" id="T4:U248">8</span>,<span class="mxinfo" id="T4:U249">7</span>)</span> = <span class="mxinfo" id="T2:U250">2.0 * (<span class="mxinfo" id="T2:U251"><span class="mxinfo" id="T2:U252"><span class="mxinfo" id="T2:U253"><span class="var type1" id="S7T2U295">q2</span> * <span class="mxinfo" id="T2:U255"><span class="var type1" id="S4T9U297">Be</span>(<span class="mxinfo" id="T4:U257">1</span>)</span></span> - <span class="mxinfo" id="T2:U258"><span class="var type1" id="S6T2U300">q1</span> * <span class="mxinfo" id="T2:U260"><span class="var type1" id="S4T9U302">Be</span>(<span class="mxinfo" id="T4:U262">2</span>)</span></span></span> + <span class="mxinfo" id="T2:U263"><span class="var type1" id="S5T2U305">q0</span> * <span class="mxinfo" id="T2:U265"><span class="var type1" id="S4T9U307">Be</span>(<span class="mxinfo" id="T4:U267">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,21" id="srcline21">21</a></span><span class="line"><span class="mxinfo" id="T4:U268"><span class="mxinfo" id="T4:U269"><span class="var type1" id="S2T32U312">H</span>(<span class="mxinfo" id="T4:U271">8</span>,<span class="mxinfo" id="T4:U272">8</span>)</span> = <span class="mxinfo" id="T2:U273">2.0 * (<span class="mxinfo" id="T2:U274"><span class="mxinfo" id="T2:U275"><span class="mxinfo" id="T2:U276"><span class="var type1" id="S8T2U321">q3</span> * <span class="mxinfo" id="T2:U278"><span class="var type1" id="S4T9U323">Be</span>(<span class="mxinfo" id="T4:U280">1</span>)</span></span> - <span class="mxinfo" id="T2:U281"><span class="var type1" id="S5T2U326">q0</span> * <span class="mxinfo" id="T2:U283"><span class="var type1" id="S4T9U328">Be</span>(<span class="mxinfo" id="T4:U285">2</span>)</span></span></span> - <span class="mxinfo" id="T2:U286"><span class="var type1" id="S6T2U331">q1</span> * <span class="mxinfo" id="T2:U288"><span class="var type1" id="S4T9U333">Be</span>(<span class="mxinfo" id="T4:U290">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,22" id="srcline22">22</a></span><span class="line"><span class="mxinfo" id="T4:U291"><span class="mxinfo" id="T4:U292"><span class="var type1" id="S2T32U338">H</span>(<span class="mxinfo" id="T4:U294">8</span>,<span class="mxinfo" id="T4:U295">9</span>)</span> = <span class="mxinfo" id="T2:U296">2.0 * (<span class="mxinfo" id="T2:U297"><span class="mxinfo" id="T2:U298"><span class="mxinfo" id="T2:U299"><span class="var type1" id="S5T2U347">q0</span> * <span class="mxinfo" id="T2:U301"><span class="var type1" id="S4T9U349">Be</span>(<span class="mxinfo" id="T4:U303">1</span>)</span></span> + <span class="mxinfo" id="T2:U304"><span class="var type1" id="S8T2U352">q3</span> * <span class="mxinfo" id="T2:U306"><span class="var type1" id="S4T9U354">Be</span>(<span class="mxinfo" id="T4:U308">2</span>)</span></span></span> - <span class="mxinfo" id="T2:U309"><span class="var type1" id="S7T2U357">q2</span> * <span class="mxinfo" id="T2:U311"><span class="var type1" id="S4T9U359">Be</span>(<span class="mxinfo" id="T4:U313">3</span>)</span></span></span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="46,23" id="srcline23">23</a></span><span class="line"><span class="mxinfo" id="T4:U314"><span class="mxinfo" id="T4:U315"><span class="var type1" id="S2T32U364">H</span>(<span class="mxinfo" id="T4:U317">8</span>,<span class="mxinfo" id="T4:U318">10</span>)</span> = <span class="mxinfo" id="T2:U319">2.0 * (<span class="mxinfo" id="T2:U320"><span class="mxinfo" id="T2:U321"><span class="mxinfo" id="T2:U322"><span class="var type1" id="S6T2U373">q1</span> * <span class="mxinfo" id="T2:U324"><span class="var type1" id="S4T9U375">Be</span>(<span class="mxinfo" id="T4:U326">1</span>)</span></span> + <span class="mxinfo" id="T2:U327"><span class="var type1" id="S7T2U378">q2</span> * <span class="mxinfo" id="T2:U329"><span class="var type1" id="S4T9U380">Be</span>(<span class="mxinfo" id="T4:U331">2</span>)</span></span></span> + <span class="mxinfo" id="T2:U332"><span class="var type1" id="S8T2U383">q3</span> * <span class="mxinfo" id="T2:U334"><span class="var type1" id="S4T9U385">Be</span>(<span class="mxinfo" id="T4:U336">3</span>)</span></span></span>)</span></span>;</span></span>
</pre>
