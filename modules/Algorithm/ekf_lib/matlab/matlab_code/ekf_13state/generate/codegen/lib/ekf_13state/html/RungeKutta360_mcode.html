<!-- saved from url=(0014)about:internet -->
<pre class="code">
<span class="srcline"><span class="lineno"><a href="102,1" id="srcline1"> 1</a></span><span class="line"><span class="keyword">function</span> <span class="var type1" id="S2T14U3">X</span>=RungeKutta(<span class="mxinfo" id="T14:U2"><span class="mxinfo" id="T14:U3"><span class="var type1" id="S2T14U6">X</span></span></span>,<span class="var type1" id="S3T13U7">U</span>,<span class="var type1" id="S4T2U8">dT</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="102,2" id="srcline2"> 2</a></span><span class="line"><span class="comment">%2nd order runge-kutta implement</span></span></span>
<span class="srcline"><span class="lineno"><a href="102,3" id="srcline3"> 3</a></span><span class="line"><span class="mxinfo" id="T14:U7"><span class="var type1" id="S5T14U11">Xlast</span>=<span class="var type1" id="S2T14U12">X</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="102,4" id="srcline4"> 4</a></span><span class="line"><span class="mxinfo" id="T17:U10"><span class="var type1" id="S6T17U15">k1</span>=<span class="mxinfo" id="T17:U12"><span class="fcn" id="F43N11:B17">f</span>(<span class="var type1" id="S2T14U18">X</span>,<span class="var type1" id="S3T13U19">U</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="102,5" id="srcline5"> 5</a></span><span class="line"><span class="mxinfo" id="T14:U15"><span class="var type1" id="S2T14U22">X</span>=<span class="mxinfo" id="T14:U17"><span class="var type1" id="S5T14U24">Xlast</span>+<span class="mxinfo" id="T14:U19"><span class="mxinfo" id="T2:U20">0.5*<span class="var type1" id="S4T2U28">dT</span></span>*<span class="var type1" id="S6T17U29">k1</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="102,6" id="srcline6"> 6</a></span><span class="line"><span class="mxinfo" id="T17:U23"><span class="var type1" id="S8T17U32">k2</span>=<span class="mxinfo" id="T17:U25"><span class="fcn" id="F43N11:B34">f</span>(<span class="mxinfo" id="T14:U26"><span class="var type1" id="S2T14U36">X</span>+<span class="mxinfo" id="T14:U28"><span class="mxinfo" id="T2:U29">0.5*<span class="var type1" id="S4T2U40">dT</span></span>*<span class="var type1" id="S6T17U41">k1</span></span></span>,<span class="var type1" id="S3T13U42">U</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="102,7" id="srcline7"> 7</a></span><span class="line"><span class="mxinfo" id="T14:U33"><span class="var type1" id="S2T14U45">X</span>=<span class="mxinfo" id="T14:U35"><span class="var type1" id="S5T14U47">Xlast</span>+<span class="mxinfo" id="T14:U37"><span class="mxinfo" id="T2:U38">0.5*<span class="var type1" id="S4T2U51">dT</span></span>*<span class="var type1" id="S8T17U52">k2</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="102,8" id="srcline8"> 8</a></span><span class="line"><span class="mxinfo" id="T17:U41"><span class="var type1" id="S9T17U55">k3</span>=<span class="mxinfo" id="T17:U43"><span class="fcn" id="F43N11:B57">f</span>(<span class="mxinfo" id="T14:U44"><span class="var type1" id="S2T14U59">X</span>+<span class="mxinfo" id="T14:U46"><span class="mxinfo" id="T2:U47">0.5*<span class="var type1" id="S4T2U63">dT</span></span>*<span class="var type1" id="S8T17U64">k2</span></span></span>,<span class="var type1" id="S3T13U65">U</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="102,9" id="srcline9"> 9</a></span><span class="line"><span class="mxinfo" id="T14:U51"><span class="var type1" id="S2T14U68">X</span>=<span class="mxinfo" id="T14:U53"><span class="var type1" id="S5T14U70">Xlast</span>+<span class="mxinfo" id="T14:U55"><span class="mxinfo" id="T2:U56">0.5*<span class="var type1" id="S4T2U74">dT</span></span>*<span class="var type1" id="S9T17U75">k3</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="102,10" id="srcline10">10</a></span><span class="line"><span class="mxinfo" id="T17:U59"><span class="var type1" id="S10T17U78">k4</span>=<span class="mxinfo" id="T17:U61"><span class="fcn" id="F43N11:B80">f</span>(<span class="mxinfo" id="T14:U62"><span class="var type1" id="S2T14U82">X</span>+<span class="mxinfo" id="T14:U64"><span class="var type1" id="S4T2U84">dT</span>*<span class="var type1" id="S9T17U85">k3</span></span></span>,<span class="var type1" id="S3T13U86">U</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="102,11" id="srcline11">11</a></span><span class="line"><span class="mxinfo" id="T14:U68"><span class="var type1" id="S2T14U89">X</span>=<span class="mxinfo" id="T14:U70"><span class="var type1" id="S5T14U91">Xlast</span>+<span class="mxinfo" id="T14:U72"><span class="mxinfo" id="T14:U73"><span class="var type1" id="S4T2U94">dT</span>*(<span class="mxinfo" id="T17:U75"><span class="mxinfo" id="T17:U76"><span class="mxinfo" id="T17:U77"><span class="var type1" id="S6T17U99">k1</span>+<span class="mxinfo" id="T17:U79"><span class="mxinfo" id="T4:U80">2</span>*<span class="var type1" id="S8T17U102">k2</span></span></span>+<span class="mxinfo" id="T17:U82"><span class="mxinfo" id="T4:U83">2</span>*<span class="var type1" id="S9T17U105">k3</span></span></span>+<span class="var type1" id="S10T17U106">k4</span></span>)</span>/<span class="mxinfo" id="T4:U86">6</span></span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="102,12" id="srcline12">12</a></span><span class="line"><span class="comment">% X=Xlast+dT*f(X,U);</span></span></span>
<span class="srcline"><span class="lineno"><a href="102,13" id="srcline13">13</a></span><span class="line"><span class="mxinfo" id="T14:U87"><span class="var type1" id="S2T14U110">X</span>=<span class="mxinfo" id="T14:U89"><span class="fcn" id="F342N16:B112">normlise_quaternion</span>(<span class="var type1" id="S2T14U113">X</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="102,14" id="srcline14">14</a></span><span class="line"></span></span>
</pre>
